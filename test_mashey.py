import main
import json


def test_closest_asteroid_approach():
    asteroids = json.loads(main.asteroid_closest_approach())

    # Determined closest miss in kilometers through manual calculations for certain asteroid ids.
    asteroidKilometerApproachDict = {'2000433': '22359243.131520978'}

    #  Corroborate that manually calculated asteroid miss distances are equal to scraped asteroid miss distances
    for asteroid in asteroids:
        if asteroid['id'] in asteroidKilometerApproachDict:
            scrapedMissDistance = float(asteroid['close_approach_data']['miss_distance']['kilometers'])
            correctMissDistance = float(asteroidKilometerApproachDict[asteroid['id']])

            assert(scrapedMissDistance == correctMissDistance)


def test_month_closest_approaches():
    # First test from Jan 3 to Feb 3
    response = json.loads(main.month_closest_approaches('2001-01-03'))

    # Dictionary with ID as key and Date as value
    asteroidDict_ID_Date = {'2086450': '2001-01-11', '2162854': '2001-01-11'}
    # Dictionary with ID as key and Miss Distance (km) as value
    asteroidDict_ID_Dist = {'2086450': '29895911.596269342', '2162854': '32448956.549979647'}

    for asteroid in response['near_monthly_approaches']:
        # Check 0 index only since close_approach data will only have on entry
        if asteroid['id'] in asteroidDict_ID_Date:
            assert asteroid['close_approach_data'][0]['close_approach_date'] == asteroidDict_ID_Date[asteroid['id']]
        if asteroid['id'] in asteroidDict_ID_Dist:
            assert asteroid['close_approach_data'][0]['miss_distance']['kilometers'] == asteroidDict_ID_Dist[asteroid['id']]


def test_nearest_misses():
    #asteroids = json.loads(main.nearest_misses())

    #with open('testing_data/nearest_misses.txt', 'w') as outfile:
    #    json.dump(asteroids, outfile)
    asteroids = json.load(open('testing_data/nearest_misses.txt'))

    for asteroid in asteroids:
        #print(asteroid['close_approach_data']['miss_distance']['kilometers'])
        #print(asteroid['id'])
        print(asteroid['name'])
        print(asteroid['close_approach_data']['miss_distance']['kilometers'])
        print(asteroid['close_approach_data']['close_approach_date'])
        #print(asteroid['close_approach_data']['close_approach_date'])

    #asteroidTopNearestMisses = [{'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3745996?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3745996', 'neo_reference_id': '3745996', 'name': '(2016 EK84)', 'designation': '2016 EK84', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3745996', 'absolute_magnitude_h': 21.45, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.1363185559, 'estimated_diameter_max': 0.3048175575}, 'meters': {'estimated_diameter_min': 136.3185558649, 'estimated_diameter_max': 304.8175575085}, 'miles': {'estimated_diameter_min': 0.0847043974, 'estimated_diameter_max': 0.1894047905}, 'feet': {'estimated_diameter_min': 447.2393708238, 'estimated_diameter_max': 1000.0576353763}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2181-09-02', 'close_approach_date_full': '2181-Sep-02 22:52', 'epoch_date_close_approach': 6679752720000, 'relative_velocity': {'kilometers_per_second': '13.2125332448', 'kilometers_per_hour': '47565.119681285', 'miles_per_hour': '29555.1156152963'}, 'miss_distance': {'astronomical': '0.0668471669', 'lunar': '26.0035479241', 'kilometers': '10000193.783774503', 'miles': '6213832.2780060214'}, 'orbiting_body': 'Venus'}, 'orbital_data': {'orbit_id': '13', 'orbit_determination_date': '2021-11-26 04:54:27', 'first_observation_date': '2016-03-02', 'last_observation_date': '2021-10-09', 'data_arc_in_days': 2047, 'observations_used': 43, 'orbit_uncertainty': '1', 'minimum_orbit_intersection': '.177386', 'jupiter_tisserand_invariant': '4.518', 'epoch_osculation': '2459600.5', 'eccentricity': '.4891569814857739', 'semi_major_axis': '1.433443414001678', 'inclination': '14.13535034471019', 'ascending_node_longitude': '314.290899628466', 'orbital_period': '626.858122023717', 'perihelion_distance': '.7322645604779544', 'perihelion_argument': '333.9119764300299', 'aphelion_distance': '2.134622267525401', 'perihelion_time': '2459444.952977473939', 'mean_anomaly': '89.32950877082716', 'mean_motion': '.574292630743611', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'APO', 'orbit_class_description': 'Near-Earth asteroid orbits which cross the Earth’s orbit similar to that of 1862 Apollo', 'orbit_class_range': 'a (semi-major axis) > 1.0 AU; q (perihelion) < 1.017 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/2487577?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '2487577', 'neo_reference_id': '2487577', 'name': '487577 (2014 YQ15)', 'designation': '487577', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2487577', 'absolute_magnitude_h': 21.2, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.1529519353, 'estimated_diameter_max': 0.3420109247}, 'meters': {'estimated_diameter_min': 152.9519353442, 'estimated_diameter_max': 342.0109247198}, 'miles': {'estimated_diameter_min': 0.095039897, 'estimated_diameter_max': 0.2125156703}, 'feet': {'estimated_diameter_min': 501.8108275547, 'estimated_diameter_max': 1122.0831222578}}, 'is_potentially_hazardous_asteroid': True, 'close_approach_data': {'close_approach_date': '2103-12-17', 'close_approach_date_full': '2103-Dec-17 23:14', 'epoch_date_close_approach': 4227376440000, 'relative_velocity': {'kilometers_per_second': '10.9047559382', 'kilometers_per_hour': '39257.1213774325', 'miles_per_hour': '24392.8485581052'}, 'miss_distance': {'astronomical': '0.0668472336', 'lunar': '26.0035738704', 'kilometers': '10000203.761952432', 'miles': '6213838.4781582816'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '50', 'orbit_determination_date': '2021-04-14 17:21:51', 'first_observation_date': '2014-12-07', 'last_observation_date': '2017-04-16', 'data_arc_in_days': 861, 'observations_used': 171, 'orbit_uncertainty': '1', 'minimum_orbit_intersection': '.00237539', 'jupiter_tisserand_invariant': '6.220', 'epoch_osculation': '2459600.5', 'eccentricity': '.2358238652734808', 'semi_major_axis': '.9637853102329725', 'inclination': '10.91750478881857', 'ascending_node_longitude': '81.83565037997268', 'orbital_period': '345.5961381171846', 'perihelion_distance': '.7365017330800322', 'perihelion_argument': '252.3499011465129', 'aphelion_distance': '1.191068887385913', 'perihelion_time': '2459687.594419980242', 'mean_anomaly': '269.2756320608661', 'mean_motion': '1.041678306827408', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'ATE', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 2062 Aten', 'orbit_class_range': 'a (semi-major axis) < 1.0 AU; q (perihelion) > 0.983 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3893451?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3893451', 'neo_reference_id': '3893451', 'name': '(2019 WY1)', 'designation': '2019 WY1', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3893451', 'absolute_magnitude_h': 24.6, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.0319561887, 'estimated_diameter_max': 0.0714562102}, 'meters': {'estimated_diameter_min': 31.9561886721, 'estimated_diameter_max': 71.4562101727}, 'miles': {'estimated_diameter_min': 0.0198566489, 'estimated_diameter_max': 0.0444008168}, 'feet': {'estimated_diameter_min': 104.8431420431, 'estimated_diameter_max': 234.436392583}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2019-11-15', 'close_approach_date_full': '2019-Nov-15 18:01', 'epoch_date_close_approach': 1573840860000, 'relative_velocity': {'kilometers_per_second': '9.0444146239', 'kilometers_per_hour': '32559.8926461761', 'miles_per_hour': '20231.4510722865'}, 'miss_distance': {'astronomical': '0.0668472995', 'lunar': '26.0035995055', 'kilometers': '10000213.620452065', 'miles': '6213844.603945897'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '3', 'orbit_determination_date': '2021-04-15 22:09:10', 'first_observation_date': '2019-11-24', 'last_observation_date': '2019-12-02', 'data_arc_in_days': 8, 'observations_used': 55, 'orbit_uncertainty': '8', 'minimum_orbit_intersection': '.0525253', 'jupiter_tisserand_invariant': '3.434', 'epoch_osculation': '2458812.5', 'eccentricity': '.5409920894375935', 'semi_major_axis': '2.22097831806172', 'inclination': '6.891274170507758', 'ascending_node_longitude': '62.04846254117795', 'orbital_period': '1208.968276692177', 'perihelion_distance': '1.019446617177918', 'perihelion_argument': '329.2996018886042', 'aphelion_distance': '3.422510018945522', 'perihelion_time': '2458786.767575785546', 'mean_anomaly': '7.662461369581595', 'mean_motion': '.2977745627742901', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'AMO', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 1221 Amor', 'orbit_class_range': '1.017 AU < q (perihelion) < 1.3 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3620867?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3620867', 'neo_reference_id': '3620867', 'name': '(2012 XE133)', 'designation': '2012 XE133', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3620867', 'absolute_magnitude_h': 23.3, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.058150704, 'estimated_diameter_max': 0.130028927}, 'meters': {'estimated_diameter_min': 58.1507039646, 'estimated_diameter_max': 130.0289270043}, 'miles': {'estimated_diameter_min': 0.0361331611, 'estimated_diameter_max': 0.0807962044}, 'feet': {'estimated_diameter_min': 190.7831555951, 'estimated_diameter_max': 426.6041048727}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2085-04-20', 'close_approach_date_full': '2085-Apr-20 02:43', 'epoch_date_close_approach': 3638572980000, 'relative_velocity': {'kilometers_per_second': '23.0535079345', 'kilometers_per_hour': '82992.6285642641', 'miles_per_hour': '51568.3918987229'}, 'miss_distance': {'astronomical': '0.0668491256', 'lunar': '26.0043098584', 'kilometers': '10000486.801122472', 'miles': '6214014.3505432336'}, 'orbiting_body': 'Merc'}, 'orbital_data': {'orbit_id': '34', 'orbit_determination_date': '2021-04-15 07:22:21', 'first_observation_date': '2012-12-12', 'last_observation_date': '2021-01-05', 'data_arc_in_days': 2946, 'observations_used': 180, 'orbit_uncertainty': '0', 'minimum_orbit_intersection': '.00241008', 'jupiter_tisserand_invariant': '7.863', 'epoch_osculation': '2459600.5', 'eccentricity': '.4325933733803336', 'semi_major_axis': '.7231810425378183', 'inclination': '6.726070905514357', 'ascending_node_longitude': '281.0295610628733', 'orbital_period': '224.6306306573418', 'perihelion_distance': '.410337715781677', 'perihelion_argument': '337.0753011772421', 'aphelion_distance': '1.03602436929396', 'perihelion_time': '2459524.823510793413', 'mean_anomaly': '121.2814834497317', 'mean_motion': '1.602630945506068', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'ATE', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 2062 Aten', 'orbit_class_range': 'a (semi-major axis) < 1.0 AU; q (perihelion) > 0.983 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/2523600?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '2523600', 'neo_reference_id': '2523600', 'name': '523600 (2003 RC2)', 'designation': '523600', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=2523600', 'absolute_magnitude_h': 19.46, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.3408434689, 'estimated_diameter_max': 0.7621491661}, 'meters': {'estimated_diameter_min': 340.84346887, 'estimated_diameter_max': 762.1491660801}, 'miles': {'estimated_diameter_min': 0.2117902471, 'estimated_diameter_max': 0.4735773895}, 'feet': {'estimated_diameter_min': 1118.2528864074, 'estimated_diameter_max': 2500.4894700422}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2033-10-17', 'close_approach_date_full': '2033-Oct-17 10:21', 'epoch_date_close_approach': 2013157260000, 'relative_velocity': {'kilometers_per_second': '21.9701990273', 'kilometers_per_hour': '79092.7164982699', 'miles_per_hour': '49145.1382041611'}, 'miss_distance': {'astronomical': '0.0668492473', 'lunar': '26.0043571997', 'kilometers': '10000505.007183251', 'miles': '6214025.6632648238'}, 'orbiting_body': 'Mars'}, 'orbital_data': {'orbit_id': '48', 'orbit_determination_date': '2021-04-14 19:23:10', 'first_observation_date': '2003-09-02', 'last_observation_date': '2021-04-13', 'data_arc_in_days': 6433, 'observations_used': 178, 'orbit_uncertainty': '0', 'minimum_orbit_intersection': '.256592', 'jupiter_tisserand_invariant': '4.156', 'epoch_osculation': '2459600.5', 'eccentricity': '.3711609645763567', 'semi_major_axis': '1.524959528668403', 'inclination': '42.31810656928646', 'ascending_node_longitude': '165.6437194427554', 'orbital_period': '687.8375863642801', 'perihelion_distance': '.9589540790679323', 'perihelion_argument': '273.1519738170597', 'aphelion_distance': '2.090964978268874', 'perihelion_time': '2459856.183435926640', 'mean_anomaly': '226.1805653568303', 'mean_motion': '.5233793662001821', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'APO', 'orbit_class_description': 'Near-Earth asteroid orbits which cross the Earth’s orbit similar to that of 1862 Apollo', 'orbit_class_range': 'a (semi-major axis) > 1.0 AU; q (perihelion) < 1.017 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3654519?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3654519', 'neo_reference_id': '3654519', 'name': '(2013 XZ21)', 'designation': '2013 XZ21', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3654519', 'absolute_magnitude_h': 20.4, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.2210828104, 'estimated_diameter_max': 0.4943561926}, 'meters': {'estimated_diameter_min': 221.0828103591, 'estimated_diameter_max': 494.3561926196}, 'miles': {'estimated_diameter_min': 0.137374447, 'estimated_diameter_max': 0.3071786018}, 'feet': {'estimated_diameter_min': 725.3373275385, 'estimated_diameter_max': 1621.9035709942}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2083-06-27', 'close_approach_date_full': '2083-Jun-27 13:57', 'epoch_date_close_approach': 3581330220000, 'relative_velocity': {'kilometers_per_second': '19.7217412297', 'kilometers_per_hour': '70998.2684267616', 'miles_per_hour': '44115.5629566175'}, 'miss_distance': {'astronomical': '0.0668493446', 'lunar': '26.0043950494', 'kilometers': '10000519.563056002', 'miles': '6214034.7078647476'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '21', 'orbit_determination_date': '2021-04-15 09:05:38', 'first_observation_date': '2013-12-12', 'last_observation_date': '2020-12-06', 'data_arc_in_days': 2551, 'observations_used': 138, 'orbit_uncertainty': '1', 'minimum_orbit_intersection': '.0633108', 'jupiter_tisserand_invariant': '4.961', 'epoch_osculation': '2459600.5', 'eccentricity': '.3740848331056019', 'semi_major_axis': '1.24103185204703', 'inclination': '32.02215900979958', 'ascending_node_longitude': '93.11777464045215', 'orbital_period': '504.9784199218213', 'perihelion_distance': '.7767806587952805', 'perihelion_argument': '110.7670525915567', 'aphelion_distance': '1.705283045298779', 'perihelion_time': '2459769.153822184078', 'mean_anomaly': '239.7663947784784', 'mean_motion': '.7129017514366924', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'APO', 'orbit_class_description': 'Near-Earth asteroid orbits which cross the Earth’s orbit similar to that of 1862 Apollo', 'orbit_class_range': 'a (semi-major axis) > 1.0 AU; q (perihelion) < 1.017 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/54087422?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '54087422', 'neo_reference_id': '54087422', 'name': '(2020 VM)', 'designation': '2020 VM', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54087422', 'absolute_magnitude_h': 26.7, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.0121494041, 'estimated_diameter_max': 0.0271668934}, 'meters': {'estimated_diameter_min': 12.14940408, 'estimated_diameter_max': 27.1668934089}, 'miles': {'estimated_diameter_min': 0.0075492874, 'estimated_diameter_max': 0.0168807197}, 'feet': {'estimated_diameter_min': 39.8602508817, 'estimated_diameter_max': 89.1302305717}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '1928-10-31', 'close_approach_date_full': '1928-Oct-31 17:27', 'epoch_date_close_approach': -1299133980000, 'relative_velocity': {'kilometers_per_second': '5.5166399695', 'kilometers_per_hour': '19859.9038902324', 'miles_per_hour': '12340.1719477947'}, 'miss_distance': {'astronomical': '0.0668496067', 'lunar': '26.0044970063', 'kilometers': '10000558.772657729', 'miles': '6214059.0715815002'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '8', 'orbit_determination_date': '2021-04-15 23:16:39', 'first_observation_date': '2020-11-04', 'last_observation_date': '2020-11-18', 'data_arc_in_days': 14, 'observations_used': 33, 'orbit_uncertainty': '7', 'minimum_orbit_intersection': '.0187667', 'jupiter_tisserand_invariant': '4.886', 'epoch_osculation': '2459600.5', 'eccentricity': '.2439048361739997', 'semi_major_axis': '1.332635290494706', 'inclination': '1.804246693524775', 'ascending_node_longitude': '226.6389178490657', 'orbital_period': '561.90822839489', 'perihelion_distance': '1.007599098286904', 'perihelion_argument': '146.3637708273909', 'aphelion_distance': '1.657671482702508', 'perihelion_time': '2459693.503456332541', 'mean_anomaly': '300.4151023462404', 'mean_motion': '.6406740136700833', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'APO', 'orbit_class_description': 'Near-Earth asteroid orbits which cross the Earth’s orbit similar to that of 1862 Apollo', 'orbit_class_range': 'a (semi-major axis) > 1.0 AU; q (perihelion) < 1.017 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3471589?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3471589', 'neo_reference_id': '3471589', 'name': '(2009 UG)', 'designation': '2009 UG', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3471589', 'absolute_magnitude_h': 23.3, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.058150704, 'estimated_diameter_max': 0.130028927}, 'meters': {'estimated_diameter_min': 58.1507039646, 'estimated_diameter_max': 130.0289270043}, 'miles': {'estimated_diameter_min': 0.0361331611, 'estimated_diameter_max': 0.0807962044}, 'feet': {'estimated_diameter_min': 190.7831555951, 'estimated_diameter_max': 426.6041048727}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '1934-11-30', 'close_approach_date_full': '1934-Nov-30 10:03', 'epoch_date_close_approach': -1107266220000, 'relative_velocity': {'kilometers_per_second': '9.1002738647', 'kilometers_per_hour': '32760.9859128796', 'miles_per_hour': '20356.4026079223'}, 'miss_distance': {'astronomical': '0.0668498899', 'lunar': '26.0046071711', 'kilometers': '10000601.138774513', 'miles': '6214085.3966657594'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '24', 'orbit_determination_date': '2021-04-15 03:04:07', 'first_observation_date': '2009-10-16', 'last_observation_date': '2016-11-04', 'data_arc_in_days': 2576, 'observations_used': 163, 'orbit_uncertainty': '0', 'minimum_orbit_intersection': '.0124974', 'jupiter_tisserand_invariant': '7.319', 'epoch_osculation': '2459600.5', 'eccentricity': '.3751093283292674', 'semi_major_axis': '.788345500047162', 'inclination': '4.96239405854', 'ascending_node_longitude': '13.83195952091329', 'orbital_period': '255.6661998892915', 'perihelion_distance': '.4926297490330706', 'perihelion_argument': '201.877706137032', 'aphelion_distance': '1.084061251061254', 'perihelion_time': '2459618.257293243330', 'mean_anomaly': '334.9962037595632', 'mean_motion': '1.408086012761511', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'ATE', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 2062 Aten', 'orbit_class_range': 'a (semi-major axis) < 1.0 AU; q (perihelion) > 0.983 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/3838913?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '3838913', 'neo_reference_id': '3838913', 'name': '(2019 EM1)', 'designation': '2019 EM1', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=3838913', 'absolute_magnitude_h': 22.3, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.0921626549, 'estimated_diameter_max': 0.2060819612}, 'meters': {'estimated_diameter_min': 92.1626548503, 'estimated_diameter_max': 206.0819612321}, 'miles': {'estimated_diameter_min': 0.057267201, 'estimated_diameter_max': 0.1280533543}, 'feet': {'estimated_diameter_min': 302.370924539, 'estimated_diameter_max': 676.1219416887}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2074-12-29', 'close_approach_date_full': '2074-Dec-29 17:53', 'epoch_date_close_approach': 3313331580000, 'relative_velocity': {'kilometers_per_second': '38.6066149574', 'kilometers_per_hour': '138983.8138467527', 'miles_per_hour': '86359.1369982781'}, 'miss_distance': {'astronomical': '0.06685039', 'lunar': '26.00480171', 'kilometers': '10000675.9526693', 'miles': '6214131.88386434'}, 'orbiting_body': 'Merc'}, 'orbital_data': {'orbit_id': '10', 'orbit_determination_date': '2021-04-15 21:06:00', 'first_observation_date': '2019-03-04', 'last_observation_date': '2019-04-28', 'data_arc_in_days': 55, 'observations_used': 127, 'orbit_uncertainty': '5', 'minimum_orbit_intersection': '.00117596', 'jupiter_tisserand_invariant': '8.283', 'epoch_osculation': '2459600.5', 'eccentricity': '.5508505455743535', 'semi_major_axis': '.6708960741131242', 'inclination': '28.45559317247793', 'ascending_node_longitude': '159.6994841618267', 'orbital_period': '200.7156807183791', 'perihelion_distance': '.3013326056642178', 'perihelion_argument': '196.7221984702169', 'aphelion_distance': '1.040459542562031', 'perihelion_time': '2459674.479626491901', 'mean_anomaly': '227.3114853719268', 'mean_motion': '1.793581840300311', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'ATE', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 2062 Aten', 'orbit_class_range': 'a (semi-major axis) < 1.0 AU; q (perihelion) > 0.983 AU'}}, 'is_sentry_object': False}, {'links': {'self': 'http://www.neowsapp.com/rest/v1/neo/54051399?api_key=FmrG2O4vhIIH0uDdm1blYB13CNhWmoy9QjeKfrjm'}, 'id': '54051399', 'neo_reference_id': '54051399', 'name': '(2020 QU5)', 'designation': '2020 QU5', 'nasa_jpl_url': 'http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=54051399', 'absolute_magnitude_h': 25.68, 'estimated_diameter': {'kilometers': {'estimated_diameter_min': 0.0194336768, 'estimated_diameter_max': 0.0434550225}, 'meters': {'estimated_diameter_min': 19.433676839, 'estimated_diameter_max': 43.4550224647}, 'miles': {'estimated_diameter_min': 0.0120755232, 'estimated_diameter_max': 0.0270016908}, 'feet': {'estimated_diameter_min': 63.7587843204, 'estimated_diameter_max': 142.5689759032}}, 'is_potentially_hazardous_asteroid': False, 'close_approach_data': {'close_approach_date': '2092-08-17', 'close_approach_date_full': '2092-Aug-17 17:25', 'epoch_date_close_approach': 3869832300000, 'relative_velocity': {'kilometers_per_second': '16.2511143897', 'kilometers_per_hour': '58504.0118029045', 'miles_per_hour': '36352.1177783103'}, 'miss_distance': {'astronomical': '0.0668505325', 'lunar': '26.0048571425', 'kilometers': '10000697.270365775', 'miles': '6214145.130066695'}, 'orbiting_body': 'Earth'}, 'orbital_data': {'orbit_id': '2', 'orbit_determination_date': '2021-04-15 22:50:48', 'first_observation_date': '2020-08-20', 'last_observation_date': '2020-08-25', 'data_arc_in_days': 5, 'observations_used': 14, 'orbit_uncertainty': '8', 'minimum_orbit_intersection': '.0107824', 'jupiter_tisserand_invariant': '7.811', 'epoch_osculation': '2459084.5', 'eccentricity': '.5818918427299655', 'semi_major_axis': '.7221850121600583', 'inclination': '.7686408969231334', 'ascending_node_longitude': '69.65882639699969', 'orbital_period': '224.1667180351528', 'perihelion_distance': '.3019514446422794', 'perihelion_argument': '100.0900122406261', 'aphelion_distance': '1.142418579677837', 'perihelion_time': '2459007.322650928206', 'mean_anomaly': '123.9427775424223', 'mean_motion': '1.60594758738247', 'equinox': 'J2000', 'orbit_class': {'orbit_class_type': 'ATE', 'orbit_class_description': 'Near-Earth asteroid orbits similar to that of 2062 Aten', 'orbit_class_range': 'a (semi-major axis) < 1.0 AU; q (perihelion) > 0.983 AU'}}, 'is_sentry_object': False}]

    exit(1)
    # Ordered top ten nearest misses tuple with id and miss distance in kilometers
    correctNearestMisses_ID_KM = [('2487577', '10000203.761952432'),
                                  ('3893451', '10000213.620452065'),
                                  ('3893451', '10000213.620452065'),
                                  ('3620867', '10000486.801122472'),
                                  ('2523600', '10000505.007183251'),
                                  ('3654519', '10000519.563056002'),
                                  ('54087422', '10000558.772657729'),
                                  ('3471589', '10000601.138774513'),
                                  ('3838913', '10000675.9526693'),
                                  ('54051399', '10000697.270365775')]

    # Cross examine scraped top ten nearest misses with manually determined top ten nearest misses.
    for index in range(10):
        # Check asteroid ID matches
        assert(correctNearestMisses_ID_KM[index][0] == asteroids[index]['id'])
        # Check asteroid distance matches
        assert(correctNearestMisses_ID_KM[index][1] == asteroids[index]['close_approach_data']['miss_distance']['kilometers'])


    #for index,

    #for index, asteroid in enumerate(asteroids):


#test_closest_asteroids()

#test_nearest_misses()

test_month_closest_approaches()
